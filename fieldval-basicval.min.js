var logger;"function"==typeof require&&(logger=require("tracer").console()),"function"==typeof require&&(FieldVal=require("fieldval"));var BasicVal={errors:{too_short:function(r){return{error:100,error_message:"Length is less than "+r}},too_long:function(r){return{error:101,error_message:"Length is greater than "+r}},too_small:function(r){return{error:102,error_message:"Value is less than "+r}},too_large:function(r){return{error:103,error_message:"Value is greater than "+r}},not_in_list:function(){return{error:104,error_message:"Value is not a valid choice"}},cannot_be_empty:function(){return{error:105,error_message:"Value cannot be empty."}},no_prefix:function(r){return{error:106,error_message:"Value does not have prefix: "+r}},invalid_email:function(){return{error:107,error_message:"Invalid email address format."}},invalid_url:function(){return{error:108,error_message:"Invalid url format."}},incorrect_length:function(r){return{error:109,error_message:"Length is not equal to "+r}},no_suffix:function(r){return{error:110,error_message:"Value does not have suffix: "+r}},invalid_date_format:function(){return{error:111,error_message:"Invalid date format."}},invalid_date:function(){return{error:112,error_message:"Invalid date."}},not_equal:function(r){return{error:113,error_message:"Not equal to "+r+"."}}},equal_to:function(r,e){var a=function(a){return a!==r?FieldVal.create_error(BasicVal.errors.not_equal,e,r):void 0};return e?(e.check=a,e):{check:a}},merge_required_and_flags:function(r,e){return"object"==typeof r?e=r:(e||(e={}),e.required=r),e},integer:function(r,e){return FieldVal.type("integer",BasicVal.merge_required_and_flags(r,e))},number:function(r,e){return FieldVal.type("number",BasicVal.merge_required_and_flags(r,e))},array:function(r,e){return FieldVal.type("array",BasicVal.merge_required_and_flags(r,e))},object:function(r,e){return FieldVal.type("object",BasicVal.merge_required_and_flags(r,e))},"float":function(r,e){return FieldVal.type("float",BasicVal.merge_required_and_flags(r,e))},"boolean":function(r,e){return FieldVal.type("boolean",BasicVal.merge_required_and_flags(r,e))},string:function(r,e){e=BasicVal.merge_required_and_flags(r,e);var a=function(a,n){var t=FieldVal.type("string",e);"object"==typeof t&&(t=t.check);var i=t(a,n);return i?i:(e&&e.trim===!1||(a=a.trim()),0===a.length?r||void 0===r?FieldVal.REQUIRED_ERROR:FieldVal.NOT_REQUIRED_BUT_MISSING:void 0)};return e?(e.check=a,e):{check:a}},length:function(r,e){var a=function(a){return a.length!==r?FieldVal.create_error(BasicVal.errors.incorrect_length,e,r):void 0};return e?(e.check=a,e):{check:a}},min_length:function(r,e){var a=function(a){return a.length<r?FieldVal.create_error(BasicVal.errors.too_short,e,r):void 0};return e?(e.check=a,e):{check:a}},max_length:function(r,e){var a=function(a){return a.length>r?FieldVal.create_error(BasicVal.errors.too_long,e,r):void 0};return e?(e.check=a,e):{check:a}},minimum:function(r,e){var a=function(a){return r>a?FieldVal.create_error(BasicVal.errors.too_small,e,r):void 0};return e?(e.check=a,e):{check:a}},maximum:function(r,e){var a=function(a){return a>r?FieldVal.create_error(BasicVal.errors.too_large,e,r):void 0};return e?(e.check=a,e):{check:a}},range:function(r,e,a){var n=function(n){return r>n?FieldVal.create_error(BasicVal.errors.too_small,a,r):n>e?FieldVal.create_error(BasicVal.errors.too_large,a,e):void 0};return a?(a.check=n,a):{check:n}},one_of:function(r,e){var a=[];if("[object Array]"===Object.prototype.toString.call(r))for(var n=0;n<r.length;n++){var t=r[n];a.push("object"==typeof t?t[0]:t)}else for(var n in r)a.push(n);var i=function(r){return-1===a.indexOf(r)?FieldVal.create_error(BasicVal.errors.not_in_list,e):void 0};return e?(e.check=i,e):{check:i}},not_empty:function(r,e){var a=function(a){if(r){if(0===a.trim().length)return FieldVal.create_error(BasicVal.errors.cannot_be_empty,e)}else if(0===a.length)return FieldVal.create_error(BasicVal.errors.cannot_be_empty,e)};return e?(e.check=a,e):{check:a}},prefix:function(r,e){var a=function(a){return a.length>=r.length?a.substring(0,r.length)!=r?FieldVal.create_error(BasicVal.errors.no_prefix,e,r):void 0:FieldVal.create_error(BasicVal.errors.no_prefix,e,r)};return e?(e.check=a,e):{check:a}},suffix:function(r,e){var a=function(a){return a.length>=r.length?a.substring(a.length-r.length,a.length)!=r?FieldVal.create_error(BasicVal.errors.no_suffix,e,r):void 0:FieldVal.create_error(BasicVal.errors.no_suffix,e,r)};return e?(e.check=a,e):{check:a}},each:function(r,e){var a=function(e){for(var a=new FieldVal(null),n=0;n<e.length;n++){var t=e[n],i=r(t,n);null!=i&&a.invalid(""+n,i)}var o=a.end();return null!=o?o:void 0};return e?(e.check=a,e):{check:a}},email:function(r){var e=function(e){var a=BasicVal.email_regex;return a.test(e)?void 0:FieldVal.create_error(BasicVal.errors.invalid_email,r)};return r?(r.check=e,r):{check:e}},date:function(r,e){for(var a={YYYY:[4],YY:[2],MM:[2],M:[1,2],DD:[2],D:[1,2]," ":0,"-":0,"/":0,":":0},n=[],t=0,i=!1;t<r.length&&!i;){var o=!1;for(var l in a){var c=r.substring(t,t+l.length);if(c===l){n.push(l),t+=l.length,o=!0;break}}o||(i=!0)}i&&console.error&&console.error("Invalid date format");var u=function(r){for(var t={},i=0,o=null,l=null,c=-1,u=!1;i<r.length&&!u;)if(c++,o=n[c],l=a[o],0!==l){for(var s=l[0],f=l[l.length-1],d="",_=0;f>_;_++){var g=r[i+_];if(void 0===g)break;var v=g.charCodeAt(0);if(48>v||v>57){if(_===s)break;u=!0;break}d+=g}if(i+=_,u)break;var h=parseInt(d);"YYYY"===o||"YY"===o?t.year=h:"MM"===o||"M"===o?t.month=h:("DD"===o||"D"===o)&&(t.day=h)}else{if(r[i]!==o){u=!0;break}i++}if(u)return FieldVal.create_error(BasicVal.errors.invalid_date_format,e);if(void 0!==t.month){var V=t.month;if(V>12)return FieldVal.create_error(BasicVal.errors.invalid_date,e);if(t.day){var m=t.day;if(t.year){var k=t.year;if(2==V)if(k%400==0||k%100!=0&&k%4==0){if(m>29)return FieldVal.create_error(BasicVal.errors.invalid_date,e)}else if(m>28)return FieldVal.create_error(BasicVal.errors.invalid_date,e)}if(4===V||6===V||9===V||11===V){if(m>30)return FieldVal.create_error(BasicVal.errors.invalid_date,e)}else if(2===V){if(m>29)return FieldVal.create_error(BasicVal.errors.invalid_date,e)}else if(m>31)return FieldVal.create_error(BasicVal.errors.invalid_date,e)}}else if(t.day&&t.day>31)return FieldVal.create_error(BasicVal.errors.invalid_date,e)};return e?(e.check=u,e):{check:u}},url:function(r){var e=function(e){var a=BasicVal.url_regex;return a.test(e)?void 0:FieldVal.create_error(BasicVal.errors.invalid_url,r)};return r?(r.check=e,r):{check:e}}};BasicVal.email_regex=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,BasicVal.url_regex=/^(https?):\/\/(((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))|((([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])))(:[1-9][0-9]+)?(\/)?([\/?].+)?$/,"undefined"!=typeof module&&(module.exports=BasicVal);